#!/usr/bin/python

import argparse
import logging

import numpy as np

from automata.render import AnimatedGif
import automata.life
import automata.diffusion

def main():
    logging.basicConfig(level=logging.ERROR)
    parser = argparse.ArgumentParser(description="Simulate some things")
    parser.add_argument("--verbose", action="store_true", help="Print lots of messages")
    parser.add_argument("--steps", type=int, default=100, help="Number of steps to model (default: %(default)s)")
    parser.add_argument("--filename", default="model.gif", help="File to output to (default: %(default)s)")
    parser.add_argument("--scenario", default="life", choices=["life", "diffusion"], help="Scenario to run (default: %(default)s)")
    parser.add_argument("--seed", default="seed", help="Seed to use (default: %(default)s)")
    parser.add_argument("--step", default="step", help="Step to use (default: %(default)s)")

    args = parser.parse_args()

    try:
        scenarioClass = dict(life=automata.life.Life, diffusion=automata.diffusion)[args.scenario]
    except ValueError:
        print "No scenario: {}".format(args.scenario)
        return False

    scenario = scenarioClass()
    gif = AnimatedGif()
    gif.append(scenario.universe())

    for step in range(args.steps):
        gif.append(scenario.step())

    gif.render(args.filename)

if __name__ == "__main__":
    main()
